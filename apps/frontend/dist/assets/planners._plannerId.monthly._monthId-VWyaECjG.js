import{r as N,R,j as e,u as P,b as W}from"./index-DgBv5UP-.js";import{T as F}from"./TiptapMonthly-BGc1WqL0.js";import{P as E}from"./PageNavigation-BLRU2MR-.js";import{T as G}from"./TLDrawComponent-DGxOpHYj.js";import"./index-CU6hF58n.js";import"./index-hgCRUPzZ.js";const K=({template:s,data:i,components:n,page_id:t,plannerId:M,primaryColor:T,children:v})=>{var w,$,_,j;const C=((w=s==null?void 0:s.content)==null?void 0:w.structure)||[],l=N.useRef(0),x=((j=(_=($=s==null?void 0:s.content)==null?void 0:$.metadata)==null?void 0:_.default_styles)==null?void 0:j["week-start-day"])||"Mon",S=R.useMemo(()=>{const r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=r.findIndex(y=>y.startsWith(x));return d===-1?r:[...r.slice(d),...r.slice(0,d)].slice(0,7)},[x]),g=(r,d,y={})=>{var u,o;const{component:a,class:c="",children:h,component_type:k,attributes:p={},styles:D={}}=r,I=k?n[k]:a,m=`${a}-${l.current++}`;if(c==="month-name")return e.jsx("div",{className:c,style:D,children:((u=i==null?void 0:i.monthInfo)==null?void 0:u.month_year)||""},m);if(c==="monthly-week-header")return e.jsx("section",{className:c,style:D,children:S.map((f,L)=>e.jsx("div",{children:f},`day-${L}`))},m);if(a==="TiptapMonthly"){const f=((o=i==null?void 0:i.days)==null?void 0:o[p.tiptap_id-1])||{};return e.jsx(F,{tiptap_id:p.tiptap_id,pageId:t,className:c,date:f.date,isCurrentMonth:f.isCurrentMonth,plannerId:M},m)}return e.jsx(I,{className:c,style:D,...p,children:h==null?void 0:h.map(f=>g(f,d,y))},m)};return e.jsxs(e.Fragment,{children:[v,e.jsx(E,{}),C.map(r=>e.jsx(R.Fragment,{children:g(r,void 0,{})},`fragment-${l.current++}`))]})},U=({template:s,page_id:i,month:n,year:t,days:M,holidays:T,moonPhases:v,tldraw_snapshots:C,plannerId:l})=>{var r,d,y;const x={TiptapMonthly:a=>e.jsx(F,{...a,monthId:`${n}_${t}`,plannerId:l}),TlDrawComponent:()=>e.jsx(G,{persistenceKey:`monthly-${n}-${t}`,plannerId:l,tldraw_snapshots:C})},S=((y=(d=(r=s==null?void 0:s.content)==null?void 0:r.metadata)==null?void 0:d.default_styles)==null?void 0:y["month-colors"])||{},g=new Date(t,n-1).toLocaleString("en-US",{month:"long"}).toLowerCase(),w=S[g]||"#ffffff",_=(()=>{const a=new Date(t,n-1,1),h=new Date(t,n,0).getDate(),p=a.getDay(),D=new Date(t,n-1,0).getDate(),m=42-h-p,u=[];for(let o=p;o>0;o--)u.push({date:new Date(t,n-2,D-o+1),isCurrentMonth:!1});for(let o=1;o<=h;o++)u.push({date:new Date(t,n-1,o),isCurrentMonth:!0});for(let o=1;o<=m;o++)u.push({date:new Date(t,n,o),isCurrentMonth:!1});return u})(),j={monthInfo:{month_year:new Date(t,n-1).toLocaleString("en-US",{month:"long"})+" "+t},days:_.map((a,c)=>({date:a.date,day_number:a.date.getDate(),isCurrentMonth:a.isCurrentMonth,tiptap_id:c+1}))};return e.jsx(K,{template:s,data:j,components:x,page_id:i,primaryColor:w,tldraw_snapshots:C,plannerId:l})},H=function(){const{template:i,monthData:n,page_id:t,planner_id:M,tldraw_snapshots:T}=P({from:W.id});return e.jsx(U,{template:i,...n,page_id:t,plannerId:M,tldraw_snapshots:T})};export{H as component};
